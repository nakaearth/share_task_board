<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <title>TaksBoard</title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
  <script type="text/javascript">
    document.addEventListener("page:change", function() {
      console.log("page changed");
    });
  </script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
  <script src="http://js.pusher.com/1.12/pusher.min.js" type="text/javascript">
  </script>
  <script type="text/javascript">
    // Enable pusher logging - don't include this in production
    Pusher.log = function(message) {
      if (window.console && window.console.log) window.console.log(message);
    };
    WEB_SOCKET_DEBUG = true;
    
    var pusher = new Pusher('<%= Pusher.key %>'); // uses your API KEY
    var channel = pusher.subscribe('taskboard_channel');
    channel.bind('my_event', function(data) {
      msg = data.message
      dom_notify(msg);
    });
    function dom_notify(msg){
      $('#notify').text(msg);
      $('#notify').fadeIn();
    }
  </script>
</head>
<body class="page-index">
<div class="div_user_content">
<% if current_user %>
<% unless controller.controller_name=="top" %>
<%= render 'common/login_info' %>
<% end %>
<%= render 'common/menu' %>
<hr/>
<% end %>
<%= yield %>
</div>
</body>
</html>
